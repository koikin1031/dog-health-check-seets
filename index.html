<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>愛犬の健康チェックシート</title>
  <meta name="theme-color" content="#4ba3ff" />
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="icon" href="icon-192.png">
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 0;
      background: #f3f4f6;
    }
    header {
      background: #4ba3ff;
      color: #fff;
      padding: 10px 16px;
      text-align: center;
      font-weight: bold;
    }
    main {
      padding: 10px 8px 40px;
      max-width: 900px;
      margin: 0 auto;
    }
    section {
      background: #fff;
      margin-bottom: 12px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.08);
      padding: 10px;
    }
    section h2 {
      margin: 0 0 8px;
      font-size: 16px;
      border-left: 4px solid #4ba3ff;
      padding-left: 6px;
    }
    .grid {
      display: grid;
      grid-template-columns: 1fr 2fr;
      gap: 6px 8px;
      align-items: center;
      font-size: 14px;
    }
    label {
      font-size: 13px;
    }
    input, textarea, select {
      width: 100%;
      box-sizing: border-box;
      padding: 6px 8px;
      border-radius: 4px;
      border: 1px solid #d1d5db;
      font-size: 14px;
      background: #f9fafb;
    }
    textarea {
      min-height: 60px;
      resize: vertical;
    }
    .row2 {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 6px;
    }
    .row3 {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 6px;
    }
    .sub-title {
      font-weight: bold;
      margin: 6px 0 4px;
      font-size: 13px;
      color: #374151;
      border-bottom: 1px dashed #e5e7eb;
    }
    .buttons {
      position: sticky;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(243,244,246,0.96);
      padding: 8px;
      display: flex;
      gap: 8px;
      justify-content: center;
      border-top: 1px solid #e5e7eb;
    }
    button {
      padding: 8px 16px;
      font-size: 14px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
    }
    .primary {
      background: #4ba3ff;
      color: #fff;
    }
    .secondary {
      background: #e5e7eb;
      color: #111827;
    }
    small {
      font-size: 11px;
      color: #6b7280;
    }
  </style>
</head>
<body>
<header>わが家のペット・おぼえ書き</header>

<main>
  <!-- 基本情報 -->
  <section>
    <h2>基本情報</h2>
    <div class="grid">
      <label for="petName">愛称</label>
      <input id="petName" name="petName" type="text" />

      <label for="petSex">性別</label>
      <select id="petSex" name="petSex">
        <option value="">選択してください</option>
        <option value="オス">オス</option>
        <option value="メス">メス</option>
      </select>

      <label for="breed">種類（犬種など）</label>
      <input id="breed" name="breed" type="text" />

      <label for="color">毛色</label>
      <input id="color" name="color" type="text" />

      <label for="birthday">生年月日</label>
      <input id="birthday" name="birthday" type="date" />

      <label for="adoptDate">飼育年月日</label>
      <input id="adoptDate" name="adoptDate" type="date" />

      <label for="height">体高(cm)</label>
      <input id="height" name="height" type="number" step="0.1" inputmode="decimal" />

      <label for="length">体長(cm)</label>
      <input id="length" name="length" type="number" step="0.1" inputmode="decimal" />

      <label for="weight">体重(kg)</label>
      <input id="weight" name="weight" type="number" step="0.1" inputmode="decimal" />

      <label for="shop">ペットショップ／元の飼主名</label>
      <input id="shop" name="shop" type="text" />

      <label for="regNo">登録番号</label>
      <input id="regNo" name="regNo" type="text" />

      <label for="tel">電話</label>
      <input id="tel" name="tel" type="tel" />

      <label for="address">住所</label>
      <textarea id="address" name="address"></textarea>
    </div>
    <small>※PHOTO欄は、写真を撮って紙の母子手帳に貼る想定にしてあります。</small>
  </section>

  <!-- ワクチン -->
  <section>
    <h2>ジステンバー・ワクチン接種日</h2>
    <div class="sub-title">ワクチン</div>
    <div class="row2">
      <div>
        <label for="vaccine1">1回目</label>
        <input id="vaccine1" name="vaccine1" type="date" />
      </div>
      <div>
        <label for="vaccine2">2回目</label>
        <input id="vaccine2" name="vaccine2" type="date" />
      </div>
    </div>

    <div class="sub-title">狂犬病予防注射接種日</div>
    <div class="row2">
      <div>
        <label for="rabies1">1回目</label>
        <input id="rabies1" name="rabies1" type="date" />
      </div>
      <div>
        <label for="rabies2">2回目</label>
        <input id="rabies2" name="rabies2" type="date" />
      </div>
    </div>
  </section>

  <!-- フィラリア検査 -->
  <section>
    <h2>フィラリア検査</h2>
    <div class="row3">
      <div>
        <label for="filariaDate1">検査日①</label>
        <input id="filariaDate1" name="filariaDate1" type="date" />
      </div>
      <div>
        <label for="filariaResult1">結果</label>
        <input id="filariaResult1" name="filariaResult1" type="text" placeholder="陰性／陽性など" />
      </div>
      <div>
        <label for="filariaDrug1">薬品名</label>
        <input id="filariaDrug1" name="filariaDrug1" type="text" />
      </div>

      <div>
        <label for="filariaDate2">検査日②</label>
        <input id="filariaDate2" name="filariaDate2" type="date" />
      </div>
      <div>
        <label for="filariaResult2">結果</label>
        <input id="filariaResult2" name="filariaResult2" type="text" />
      </div>
      <div>
        <label for="filariaDrug2">薬品名</label>
        <input id="filariaDrug2" name="filariaDrug2" type="text" />
      </div>
    </div>
  </section>

  <!-- 検便・駆虫 -->
  <section>
    <h2>検便・駆虫</h2>
    <div class="sub-title">検便</div>
    <div class="row3">
      <div>
        <label for="stoolDate1">検便日①</label>
        <input id="stoolDate1" name="stoolDate1" type="date" />
      </div>
      <div>
        <label for="parasite1">寄生虫名</label>
        <input id="parasite1" name="parasite1" type="text" />
      </div>
      <div>
        <label for="dewormDrug1">駆虫薬品名</label>
        <input id="dewormDrug1" name="dewormDrug1" type="text" />
      </div>

      <div>
        <label for="stoolDate2">検便日②</label>
        <input id="stoolDate2" name="stoolDate2" type="date" />
      </div>
      <div>
        <label for="parasite2">寄生虫名</label>
        <input id="parasite2" name="parasite2" type="text" />
      </div>
      <div>
        <label for="dewormDrug2">駆虫薬品名</label>
        <input id="dewormDrug2" name="dewormDrug2" type="text" />
      </div>
    </div>
  </section>

  <!-- 病気 -->
  <section>
    <h2>病気の記録</h2>
    <div class="row3">
      <div>
        <label for="illDate1">病気になった日①</label>
        <input id="illDate1" name="illDate1" type="date" />
      </div>
      <div>
        <label for="illName1">病名</label>
        <input id="illName1" name="illName1" type="text" />
      </div>
      <div>
        <label for="illCost1">費用(円)</label>
        <input id="illCost1" name="illCost1" type="number" inputmode="decimal" />
      </div>

      <div>
        <label for="illDate2">病気になった日②</label>
        <input id="illDate2" name="illDate2" type="date" />
      </div>
      <div>
        <label for="illName2">病名</label>
        <input id="illName2" name="illName2" type="text" />
      </div>
      <div>
        <label for="illCost2">費用(円)</label>
        <input id="illCost2" name="illCost2" type="number" inputmode="decimal" />
      </div>

      <div>
        <label for="illDate3">病気になった日③</label>
        <input id="illDate3" name="illDate3" type="date" />
      </div>
      <div>
        <label for="illName3">病名</label>
        <input id="illName3" name="illName3" type="text" />
      </div>
      <div>
        <label for="illCost3">費用(円)</label>
        <input id="illCost3" name="illCost3" type="number" inputmode="decimal" />
      </div>
    </div>
  </section>

  <!-- 備考 -->
  <section>
    <h2>備考欄</h2>
    <textarea id="memo" name="memo" placeholder="気づいたこと・注意点など"></textarea>
  </section>
</main>

<div class="buttons">
  <button class="primary" id="saveBtn">保存</button>
  <button class="secondary" id="clearBtn">全て消す</button>
</div>

<script>
  const STORAGE_KEY = 'pet-memo-v1';

  function getAllInputs() {
    return document.querySelectorAll('input, textarea, select');
  }

  function saveData() {
    const data = {};
    getAllInputs().forEach(el => {
      data[el.id] = el.value;
    });
    try {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
      alert('保存しました（この端末のブラウザ内）');
    } catch (e) {
      alert('保存に失敗しました（容量オーバーの可能性）');
    }
  }

  function loadData() {
    const raw = localStorage.getItem(STORAGE_KEY);
    if (!raw) return;
    try {
      const data = JSON.parse(raw);
      getAllInputs().forEach(el => {
        if (data[el.id] !== undefined) el.value = data[el.id];
      });
    } catch (e) {
      console.warn('データ読み込み失敗', e);
    }
  }

  function clearData() {
    if (!confirm('全ての入力内容と保存データを削除します。よろしいですか？')) return;
    localStorage.removeItem(STORAGE_KEY);
    getAllInputs().forEach(el => el.value = '');
  }

  document.getElementById('saveBtn').addEventListener('click', saveData);
  document.getElementById('clearBtn').addEventListener('click', clearData);

  // 入力するたびに自動保存したければコメント外す
  // getAllInputs().forEach(el => {
  //   el.addEventListener('change', saveData);
  // });

  window.addEventListener('load', () => {
    loadData();

    // PWA用 Service Worker 登録
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./sw.js').catch(console.error);
    }
  });
</script>
</body>
</html>
